#- name: Install ESGF tomcat
#  hosts: servers
#  vars:
#    esghome: "{{ root }}/{{ inventory_hostname }}/esgf"
#  vars_files:
#    - secrets.yml
#  roles:
#    - role: esgftomcat
#      tomcat: "{{ tomcats.esgf }}"
#  tasks:
#    - name: Copy truststore
#      copy: src={{ certs }}/esg-truststore.ts dest={{ tomcats.esgf.truststore }} mode=644
#    
#    - name: Copy keystore
#      copy: src={{ certs }}/esg-keystore.ts dest={{ tomcats.esgf.keystore }} mode=600
#
#    - name: Create content/thredds
#      file: state=directory dest={{ esg.content }}/thredds
#
#    - name: Copy UDG threddsConfig.xml
#      copy: src=files/threddsConfig.xml dest={{ esg.content }}/thredds/threddsConfig.xml
#
#    - name: Create esgf-content
#      file: state=directory dest={{ tomcats.esgf.home }}/content/thredds
#
#    - name: Clone esgf-content
#      run_once: True
#      local_action:
#        module: git
#        repo: git@gitlab.com:zequihg50/esgf-content.git
#        dest: esgf-content
#        version: master
#        depth: 1
#        force: True
#          #executable: /oceano/gmeteo/WORK/zequi/miniconda3/bin/git
#
#    - name: Copy esgf-content
#      synchronize:
#        src: esgf-content/
#        dest: "{{ tomcats.esgf.home }}/content/thredds"
#
#
#    - name: Clone tds-content
#      run_once: True
#      local_action:
#        module: git
#        repo: git@gitlab.com:zequihg50/esgf-content.git
#        dest: esgf-content
#        version: master
#        depth: 1
#
#    - name: Synchronize esgf-content
#      synchronize: src=esgf-content/ dest={{ esg.content }}/thredds
